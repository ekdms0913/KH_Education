# 8.19 Mail Server 실습2, 다람쥐 웹 메일

### 1. Mail Server 실습2

![](C:\Users\user1\Desktop\Mail 실습-2.png)

DHCP Server 50.50.50.10

DNS Server 50.50.50.20

Mail Server 50.50.50.30

PC 

내꺼  router 200.200.200.113



재은이 router 200.200.200.148 

​            DNS Server 100.100.100.80



### ROUTER

#### SW1

```
conf t
vlan 10
name v10
vlan 20
name v20
exit

in f1/0
switchport mode access
switchport access vlan 10

in range f1/14 - 15
switchport mode trunk
switchport trunk encapsulation dot1q
switchport trunk allowed vlan 1,10,20,1002-1005
exit
```

#### SW2

```
conf t
vlan 10
name v10
vlan 20
name v20
exit

in f1/0
sw mo ac
sw ac vlan 20
in f1/15
sw mo tr
sw tr en dot1q
sw tr all vlan 1,10,20,1002-1005
```

#### L3

```
@L3
conf t
vlan 10
name v10
vlan 20
name v20
exit

in f1/14
sw mo tr
sw tr en dot1q
sw tr all vlan 1,10,20,1002-1005

in f0/0
ip addr 172.16.10.254 255.255.255.0
ip nat in 
no sh

in f0/1
ip addr 200.200.200.113 255.255.255.0
ip nat out
no sh

ip route 0.0.0.0 0.0.0.0 200.200.200.254

access-list 1 permit 172.16.10.0 0.0.0.255
ip nat inside source list 1 in f0/1

in vlan 10
ip addr 50.50.50.254 255.255.255.0
ip helper-address 172.16.10.100
ip nat in
no sh

in vlan 20
ip addr 10.10.20.254 255.255.255.0
ip helper-address 172.16.10.100
ip nat in
no sh

access-list 1 permit 10.10.20.0 0.0.0.255
ip route 100.100.100.0 255.255.255.0 200.200.200.148 /// 이거 !!!
```



### DHCP

[root@Linux-04 named]# vim /etc/sysconfig/network-scripts/ifcfg-eth0

```
  1 DEVICE=eth0
  2 TYPE=Ethernet
  3 ONBOOT=yes
  4 NM_CONTROLLED=no
  5 BOOTPROTO=statict
  6 IPADDR=50.50.50.10
  7 NETMASK=255.255.255.0
  8 GATEWAY=50.50.50.254
  9 DNS1=168.126.63.1
 10 DNS2=8.8.8.8
```

[root@Linux-04 named]# service network restart

[root@Linux-04 named]# vim /etc/dhcp/dhcpd.conf

```
 1 Subnet 50.50.50.0 netmask 255.255.255.0 {
  2         range 50.50.50.50 50.50.50.100; // Clinet IP 할당 범위
  3         option routers 50.50.50.254; //게이트웨이
  4         option domain-name-servers 50.50.50.20; //DNS 서버 주소
  5         default-lease-time 21600;
  6 }
```

[root@Linux-04 named]# service dhcpd restart

+Client(WinXP) 가서 ncpa.cpl 가서 IP랑 DNS  자동자동 할당 바꾸기

+DHCP = 동적 주소 할당 방식을 쓰기 위한 프로토콜

### Mail

[root@Linux-04 tmp]# vim /etc/sysconfig/network-scripts/ifcfg-eth0

```
DEVICE=eth0
TYPE=Ethernet
ONBOOT=yes
NM_CONTROLLED=no
BOOTPROTO=static
IPADDR=50.50.50.30
NETMASK=255.255.255.0
GATEWAY=50.50.50.254
DNS1=168.126.63.1
DNS2=8.8.8.8
```

[root@Linux-04 tmp]# vim /etc/resolv.conf

```
; generated by /sbin/dhclient-script
nameserver 50.50.50.20 //추가
nameserver 168.126.63.1
```

[root@Linux-04 tmp]# vim /etc/dovecot/dovecot.conf

```
#20 protocols = imap pop3 lmtp -> 사용할 프로토콜
20 protocols = imap pop3 lmtp -> 주석 해제

#26 listen = *, :: -> 실제 메일을 받을 때 사용할 ip주소 설정_주석해제
26 listen = * -> 주석해제, *은 IPv4, ::은 IPv6 우린 IPv4만 할거라 *만 남겨둠                  
```

[root@Linux-04 tmp]# vim /etc/dovecot/conf.d/10-auth.conf  -> 도베콧 인증과 관련된 설정

```
#9 disable_plaintext_auth = yes -> 평문인증 사용 안하겠다 = 암호화로 사용하겠다_주석해제
9 disable_plaintext_auth = no  -> 주석해제, 수업 시간엔 평문으로 할거라 no로 바꿔주기
```

[root@Linux-04 tmp]# vim /etc/dovecot/conf.d/10-ssl.conf 

```
 #6 ssl = yes
 6 ssl = no -> 원래 yes인데 no로 바꿔주고 주석 해제
```

[root@Linux-04 tmp]# vim /etc/dovecot/conf.d/10-master.conf -> 포트 설정_근데 바꿀거X

[root@Linux-04 tmp]# vim /etc/dovecot/conf.d/10-mail.conf  -> 메일함 지정

```
#24    mail_location = maildir:~/Maildir -> 메일함 지정
                                            포스트 픽스에서 지정한 메일함과 똑같아야함
24    mail_location = maildir:~/Maildir -> 주석 해제
```

[root@Linux-04 tmp]# service dovecot restart

```
Dovecot Imap 를 정지 중:                                   [  OK  ]
Dovecot Imap (을)를 시작 중:                               [  OK  ]

```

[root@Linux-04 tmp]# netstat -atunp | grep :25

```
tcp        0      0 0.0.0.0:25                  0.0.0.0:*                   LISTEN      50288/master        
tcp        0      0 :::25                       :::*                        LISTEN      50288/master        

```

[root@Linux-04 tmp]# netstat -atunp | grep dovecot

```
tcp        0      0 0.0.0.0:110                 0.0.0.0:*                   LISTEN      50603/dovecot       
tcp        0      0 0.0.0.0:143                 0.0.0.0:*                   LISTEN      50603/dovecot      
```

 

[root@Linux-04 tmp]# vim /etc/postfix/main.cf

```
 77 myhostname = mail.daum.net
 85 mydomain = daum.net
101 myorigin = $mydomain //주석해제

115 inet_interfaces = all //주석해제
118 #inet_interfaces = localhost //주석처리

168 mydestination = $myhostname, localhost.$mydomain, localhost, $mydomain,mail.$mydomain, w    ww.$mydomain, ftp.$mydomain, mx.$mydomain
 //한줄로 합치기, mx.$mydomain 추가해주기 (미리해준거임)
 
 268 mynetworks = 0.0.0.0/0 //추가해주기
 421 home_mailbox = Maildir/ //주석해제
```

[root@Linux-04 tmp]# service postfix restart

```
postfix 종료 중:                                           [  OK  ]
postfix를 시작 중:                                         [  OK  ]
```



### DNS

[root@Linux-04 tmp]# vim /etc/sysconfig/network-scripts/ifcfg-eth0

```
DEVICE=eth0
TYPE=Ethernet
ONBOOT=yes
NM_CONTROLLED=no
BOOTPROTO=static
IPADDR=50.50.50.20
NETMASK=255.255.255.0
GATEWAY=50.50.50.254
DNS1=168.126.63.1
DNS2=8.8.8.8
```

[root@Linux-04 named]# service network restart

[root@Linux-04 named]# vim /etc/named.conf

```
options {
        listen-on port 53 { any; }; //any
#       listen-on-v6 port 53 { ::1; };
```

[root@Linux-04 named]# vim /etc/named.rfc1912.zones

```
zone "daum.net" IN {
        type master;
        file "daum.net.zone";
        allow-transfer { none; };
};

zone "50.50.50.in-addr.arpa" IN {  // resolv 해줄거면 이거 추가
        type master;
        file "daum.net.rev";
        allow-transfer { none; };
};

```

[root@Linux-04 named]# vim daum.net.zone

```
$TTL 1D
@       IN SOA  ns1.daum.net.            rname.invalid. (
                                        0       ; serial
                                        1D      ; refresh
                                        1H      ; retry
                                        1W      ; expire
                                        3H )    ; minimum


        IN      NS      ns1.daum.net.
        IN      A       50.50.50.20

        IN      MX      10      mail.daum.net.

ns1     IN      A       50.50.50.20
mail    IN      A       50.50.50.30
```

[root@Linux-04 named]# cp daum.net.zone daum.net.rev
[root@Linux-04 named]# vim daum.net.rev

```
$TTL 1D
@       IN SOA  ns1.daum.net.            rname.invalid. (
                                        0       ; serial
                                        1D      ; refresh
                                        1H      ; retry
                                        1W      ; expire
                                        3H )    ; minimum


        IN      NS      ns1.daum.net.
        IN      A       50.50.50.20

        IN      MX      10      mail.daum.net.

20      IN      PTR     ns1.daum.net.
30      IN      PTR     mail.daum.net.

```

[root@Linux-04 named]# chgrp named daum.net.*

[root@Linux-04 named]# vim /etc/named.rfc1912.zones

```
zone "naver.com" IN {
        type forward;
        forwarders { 100.100.100.80; }; //상대방꺼 DNS IP 주소 입력

};
```

[root@Linux-04 named]# service named restart

```
named 정지 중:                                             [  OK  ]
named 시작 중:                                             [  OK  ]
```



##### 오류찾기

Wireshark를 켜고 메일을 보낸 후 Filter를 smtp로 설정한다.



##### 오류가 났던 부분

@Mail

[root@Linux-04 tmp]# ps -ef | grep dhclient // 이놈이 켜져있었음

```
root      42463      1  0 Aug18 ?        00:00:00 dhclient eth0
root      50980  50844  0 12:27 pts/1    00:00:00 grep dhclient
```

[root@Linux-04 tmp]# kill -9 42463 //꺼주기

메일 보내진다 이제~

+Client(WinXP) 에서 ipconfig /displaydns 확인 해보기!



### 2. 다람쥐 (Squirrel) 웹 메일

- SMTP 서버와 IMAP서버를 기반으로 동작하는 PHP로 개발된 클라이언트용 웹 메일 프로그램
- 오픈소스로 공개되어 있으므로 보다 개선된 웹 메일을 만들어서 사용하 수 있음 단 , PHP를 알아야겠죠?



#### 다람쥐 웹 메일 구성

1. 패키지 설치

   - epel 저장소 (Extra Packages for Enterprise Linux - 엔터라이즈 리눅스를 위한 확장(추가)패키지 저장소)

   - #yum -y install epel-release  (추가 저장소를 깔아준거임)

     + http://squirrelmail.org/ 가서 까는 방법도 있음 (BUT,,,귀,,,ㅊ,,,ㅏ,,)

   - #vim /etc/yum.repos.d/epel.repo

      -> enabled=1 -> enabled=0 으로 변경

      -> baseurl 주석 해제, mirrorlist 주석처리

   - #yum -y --enablerepo=epel install squirrelmail (enablerepo 에서 저장소를 바꿔준거임)

     

2. 소유권 설정

   - #chown apache. -R /usr/share/squirrelmail/ (아파치-익명계정)

   - #chown apache. /etc/squirrelmail/config.php

   - #chown apache. -R /var/lib/squirrelmail/

   - #chown apache. -R /var/spool/squirrelmail/

     (-R : 하위 파일까지 다 변환해주는 option)

     

3. 다람쥐 웹 메일 환경 설정

   - #/usr/share/squirrelmail/config/conf.pl

     2 (Server setting) -> 1 (Domain) -> 2bwithu.com -> 3 (Send or SMTP) -> 2 (SMTP) -> A (Update IMAP Setting) -> 4 (IMAP Server) -> mail.2bwithu.com -> 8 (Server software) -> dovecot -> B (Update SMTP Settings) -> 4 (SMTP Server) -> mail.2bwithu.com -> 

     

4. 웹 서비스 구성 정보 확인 및 구동

   - #vim /etc/httpd/conf.d/squirrelmail.conf
   - RewriteCond    %{HTTPS} !=on -> off 변경해주기
   - #service httpd restart



#### 설정

VMnet1

DNS : 10.10.10.100

mail : 10.10.10.50

client : 10.10.10.10



##### <기본세팅>

######  Router [VMnet1 - Router - 외부연결]

```
conf t
in f0/0
ip addr 10.10.10.254 255.255.255.0
ip nat in
no sh

in f0/1
ip addr 200.200.200.111 255.255.255.0
ip nat out
no sh

ip route 0.0.0.0 0.0.0.0 200.200.200.254
access-list 1 permit 10.10.10.0 0.0.0.255
ip nat inside source list 1 in f0/1
```



###### DNS

[root@Linux-04 named]# vim /etc/sysconfig/network-scripts/ifcfg-eth0

```
DEVICE=eth0
TYPE=Ethernet
ONBOOT=yes
NM_CONTROLLED=no
BOOTPROTO=static
IPADDR=10.10.10.100
NETMASK=255.255.255.0
GATEWAY=10.10.10.254
DNS1=168.126.63.1
DNS2=8.8.8.8        
```

[root@Linux-04 named]# service network restart



[root@Linux-04 named]# vim /etc/named.rfc1912.zones

```
zone "2bwithu.com" IN {
        type master;
        file "2bwithu.com.zone";
        allow-transfer { none; } ;
};


zone "10.10.10.in-addr.arpa" IN {
        type master;
        file "2bwithu.com.rev";
        allow-transfer { none; };
};

```

[root@Linux-04 named]# mv daum.net.zone 2bwithu.com.zone
[root@Linux-04 named]# mv daum.net.rev 2bwithu.com.rev

[root@Linux-04 named]# vim 2bwithu.com.zone

```
$TTL 1D
@       IN SOA  ns1.2bwithu.com.                 root.2bwithu.com. (
                                        0       ; serial
                                        1D      ; refresh
                                        1H      ; retry
                                        1W      ; expire
                                        3H )    ; minimum


        IN      NS      ns1.2bwithu.com.
        IN      A       10.10.10.100

        IN      MX      10      mail.2bwithu.com.

ns1     IN      A       10.10.10.100
www     IN      A       10.10.10.50
mail    IN      A       10.10.10.50

```

[root@Linux-04 named]# vim 2bwithu.com.rev

```
$TTL 1D
@       IN SOA  ns1.2bwithu.com.                 root.2bwithu.com. (
                                        0       ; serial
                                        1D      ; refresh
                                        1H      ; retry
                                        1W      ; expire
                                        3H )    ; minimum


        IN      NS      ns1.2bwithu.com.
        IN      A       10.10.10.100


100     IN      PTR     ns1.2bwithu.com.
50      IN      PTR     www.2bwithu.com. //어차피 IP는 하나라 mail 안해줘도 됨
```

[root@Linux-04 named]# service named restart



###### WebMail

[root@Linux-04 tmp]# vim /etc/sysconfig/network-scripts/ifcfg-eth0

```
DEVICE=eth0
TYPE=Ethernet
ONBOOT=yes
NM_CONTROLLED=no
BOOTPROTO=static
IPADDR=10.10.10.50
NETMASK=255.255.255.0
GATEWAY=10.10.10.254
DNS1=168.126.63.1
DNS2=8.8.8.8

```

[root@Linux-04 tmp]# vim /etc/resolv.conf

```
nameserver 168.126.63.1
nameserver 8.8.8.8
```

[root@Linux-04 tmp]# ps -ef | grep dhclient

```
root      52098   3390  0 15:32 pts/0    00:00:00 grep dhclient

-> 이거 한 줄만 떠야해! 만약 두개가 뜬다면 kill -9 숫자(52098)
```



##### <1.패키지 설치>

###### WebMail

[root@Linux-04 tmp]# yum -y install epel-release

[root@Linux-04 tmp]# cd /etc/yum.repos.d/
[root@Linux-04 yum.repos.d]# ls -l

```
합계 32
-rw-r--r--. 1 root root 1991 2015-08-04 01:13 CentOS-Base.repo
-rw-r--r--. 1 root root  647 2015-08-04 01:13 CentOS-Debuginfo.repo
-rw-r--r--. 1 root root  630 2015-08-04 01:13 CentOS-Media.repo
-rw-r--r--. 1 root root 6259 2015-08-04 01:13 CentOS-Vault.repo
-rw-r--r--. 1 root root  289 2015-08-04 01:13 CentOS-fasttrack.repo
-rw-r--r--  1 root root 1056 2012-11-05 12:52 epel-testing.repo
-rw-r--r--  1 root root  957 2012-11-05 12:52 epel.repo
```

-> 패키지 설치하면 무조건 epel 저장소에서 받아옴 



[root@Linux-04 yum.repos.d]# vim epel.repo

```
  6 enabled=0 //1을 0으로 바꿔줌 
```

[root@Linux-04 yum.repos.d]# yum -y --enablerepo=epel install squirrelmail

###### 오류남 

[root@Linux-04 yum.repos.d]# vim /etc/yum.repos.d/epel.repo

```
3 baseurl=http://download.fedoraproject.org/pub/epel/6/$basearch
4 #mirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-6&arch=$basearch
  
12 baseurl=http://download.fedoraproject.org/pub/epel/6/$basearch/debug
13 #mirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-debug-6&arch=$bas    earch

-> Base 는 주석 해제 Mirrorlist 는 주석처리 해주기
```

[root@Linux-04 yum.repos.d]# yum -y --enablerepo=epel install squirrelmail ( 만약 또 오류나면 yum clean all 해주기)



##### <2. 소유권 설정>

###### WebMail

[root@Linux-04 yum.repos.d]# chown apache. -R /usr/share/squirrelmail/
[root@Linux-04 yum.repos.d]# chown apache./etc/squirrelmail/config.php
[root@Linux-04 yum.repos.d]# chown apache. -R /var/lib/squirrelmail/
[root@Linux-04 yum.repos.d]# chown apache. -R /var/spool/squirrelmail/



##### <3. 다람쥐 웹 메일 환경 설정>

###### WebMail

```
SquirrelMail Configuration : Read: config.php (1.4.0)
---------------------------------------------------------
Main Menu --
1.  Organization Preferences
2.  Server Settings
3.  Folder Defaults
4.  General Options
5.  Themes
6.  Address Books
7.  Message of the Day (MOTD)
8.  Plugins
9.  Database
10. Languages

D.  Set pre-defined settings for specific IMAP servers

C   Turn color off
S   Save data
Q   Quit

Command >> 2 //2 입력

SquirrelMail Configuration : Read: config.php (1.4.0)
---------------------------------------------------------
Server Settings

General
-------
1.  Domain                 : localhost
2.  Invert Time            : false
3.  Sendmail or SMTP       : Sendmail

A.  Update IMAP Settings   : localhost:143 (uw)
B.  Change Sendmail Config : /usr/sbin/sendmail

R   Return to Main Menu
C   Turn color off
S   Save data
Q   Quit

Command >> 1 // 1 입력

The domain name is the suffix at the end of all email addresses.  If
for example, your email address is jdoe@example.com, then your domain
would be example.com.

[localhost]: 2bwithu.com // 2bwithu.com 입력

SquirrelMail Configuration : Read: config.php (1.4.0)
---------------------------------------------------------
Server Settings

General
-------
1.  Domain                 : 2bwithu.com
2.  Invert Time            : false
3.  Sendmail or SMTP       : Sendmail

A.  Update IMAP Settings   : localhost:143 (uw)
B.  Change Sendmail Config : /usr/sbin/sendmail

R   Return to Main Menu
C   Turn color off
S   Save data
Q   Quit

Command >> 3 // 3 입력


You now need to choose the method that you will use for sending
messages in SquirrelMail.  You can either connect to an SMTP server
or use sendmail directly.

  1.  Sendmail
  2.  SMTP
Your choice [1/2] [1]: 2 // 2 입력

SquirrelMail Configuration : Read: config.php (1.4.0)
---------------------------------------------------------
Server Settings

General
-------
1.  Domain                 : 2bwithu.com
2.  Invert Time            : false
3.  Sendmail or SMTP       : SMTP

A.  Update IMAP Settings   : localhost:143 (uw)
B.  Update SMTP Settings   : localhost:25

R   Return to Main Menu
C   Turn color off
S   Save data
Q   Quit

Command >> A // A 입력

SquirrelMail Configuration : Read: config.php (1.4.0)
---------------------------------------------------------
Server Settings

General
-------
1.  Domain                 : 2bwithu.com
2.  Invert Time            : false
3.  Sendmail or SMTP       : SMTP

IMAP Settings
--------------
4.  IMAP Server            : localhost
5.  IMAP Port              : 143
6.  Authentication type    : login
7.  Secure IMAP (TLS)      : false
8.  Server software        : uw
9.  Delimiter              : /

B.  Update SMTP Settings   : localhost:25
H.  Hide IMAP Server Settings

R   Return to Main Menu
C   Turn color off
S   Save data
Q   Quit

Command >> 4 // 4 입력

This is the hostname where your IMAP server can be contacted.
[localhost]: mail.2bwithu.com // mail.2bwithu.com 입력

SquirrelMail Configuration : Read: config.php (1.4.0)
---------------------------------------------------------
Server Settings

General
-------
1.  Domain                 : 2bwithu.com
2.  Invert Time            : false
3.  Sendmail or SMTP       : SMTP

IMAP Settings
--------------
4.  IMAP Server            : mail.2bwithu.com
5.  IMAP Port              : 143
6.  Authentication type    : login
7.  Secure IMAP (TLS)      : false
8.  Server software        : uw
9.  Delimiter              : /

B.  Update SMTP Settings   : localhost:25
H.  Hide IMAP Server Settings

R   Return to Main Menu
C   Turn color off
S   Save data
Q   Quit

Command >> 8 // 8 입력

Each IMAP server has its own quirks.  As much as we tried to stick
to standards, it doesn't help much if the IMAP server doesn't follow
the same principles.  We have made some work-arounds for some of
these servers.  If you would like to use them, please select your
IMAP server.  If you do not wish to use these work-arounds, you can
set this to "other", and none will be used.
    bincimap    = Binc IMAP server
    courier     = Courier IMAP server
    cyrus       = Cyrus IMAP server
    dovecot     = Dovecot Secure IMAP server
    exchange    = Microsoft Exchange IMAP server
    hmailserver = hMailServer
    macosx      = Mac OS X Mailserver
    mercury32   = Mercury/32
    uw          = University of Washington's IMAP server
    gmail       = IMAP access to Google mail (Gmail) accounts
    other       = Not one of the above servers
[uw]: dovecot // dovecot 입력

SquirrelMail Configuration : Read: config.php (1.4.0)
---------------------------------------------------------
Server Settings

General
-------
1.  Domain                 : 2bwithu.com
2.  Invert Time            : false
3.  Sendmail or SMTP       : SMTP

IMAP Settings
--------------
4.  IMAP Server            : mail.2bwithu.com
5.  IMAP Port              : 143
6.  Authentication type    : login
7.  Secure IMAP (TLS)      : false
8.  Server software        : dovecot
9.  Delimiter              : /

B.  Update SMTP Settings   : localhost:25
H.  Hide IMAP Server Settings

R   Return to Main Menu
C   Turn color off
S   Save data
Q   Quit

Command >> B // B 입력

SquirrelMail Configuration : Read: config.php (1.4.0)
---------------------------------------------------------
Server Settings

General
-------
1.  Domain                 : 2bwithu.com
2.  Invert Time            : false
3.  Sendmail or SMTP       : SMTP

SMTP Settings
-------------
4.   SMTP Server           : localhost
5.   SMTP Port             : 25
6.   POP before SMTP       : false
7.   SMTP Authentication   : none
8.   Secure SMTP (TLS)     : false
9.   Header encryption key : 

A.  Update IMAP Settings   : mail.2bwithu.com:143 (dovecot)
H.  Hide SMTP Settings

R   Return to Main Menu
C   Turn color off
S   Save data
Q   Quit

Command >> 4 // 4 입력

This is the hostname of your SMTP server.
[localhost]: mail.2bwithu.com // mail.2bwithu.com  입력

SquirrelMail Configuration : Read: config.php (1.4.0)
---------------------------------------------------------
Server Settings

General
-------
1.  Domain                 : 2bwithu.com
2.  Invert Time            : false
3.  Sendmail or SMTP       : SMTP

SMTP Settings
-------------
4.   SMTP Server           : mail.2bwithu.com
5.   SMTP Port             : 25
6.   POP before SMTP       : false
7.   SMTP Authentication   : none
8.   Secure SMTP (TLS)     : false
9.   Header encryption key : 

A.  Update IMAP Settings   : mail.2bwithu.com:143 (dovecot)
H.  Hide SMTP Settings

R   Return to Main Menu
C   Turn color off
S   Save data
Q   Quit

Command >> S // S 입력

Data saved in config.php
Press enter to continue... // Enter 치기!

SquirrelMail Configuration : Read: config.php (1.4.0)
---------------------------------------------------------
Server Settings

General
-------
1.  Domain                 : 2bwithu.com
2.  Invert Time            : false
3.  Sendmail or SMTP       : SMTP

SMTP Settings
-------------
4.   SMTP Server           : mail.2bwithu.com
5.   SMTP Port             : 25
6.   POP before SMTP       : false
7.   SMTP Authentication   : none
8.   Secure SMTP (TLS)     : false
9.   Header encryption key : 

A.  Update IMAP Settings   : mail.2bwithu.com:143 (dovecot)
H.  Hide SMTP Settings

R   Return to Main Menu
C   Turn color off
S   Save data
Q   Quit

Command >> R // R 입력


SquirrelMail Configuration : Read: config.php (1.4.0)
---------------------------------------------------------
Main Menu --
1.  Organization Preferences
2.  Server Settings
3.  Folder Defaults
4.  General Options
5.  Themes
6.  Address Books
7.  Message of the Day (MOTD)
8.  Plugins
9.  Database
10. Languages

D.  Set pre-defined settings for specific IMAP servers

C   Turn color off
S   Save data
Q   Quit

Command >> 10 // 10 입력

SquirrelMail Configuration : Read: config.php (1.4.0)
---------------------------------------------------------
Language preferences
1.  Default Language       : en_US
2.  Default Charset        : iso-8859-1
3.  Enable lossy encoding  : false

R   Return to Main Menu
C   Turn color off
S   Save data
Q   Quit

Command >> 1 // 1 입력

SquirrelMail attempts to set the language in many ways.  If it
can not figure it out in another way, it will default to this
language.  Please use the code for the desired language.

[en_US]: ko_KR // ko_KR 입력

SquirrelMail Configuration : Read: config.php (1.4.0)
---------------------------------------------------------
Language preferences
1.  Default Language       : ko_KR
2.  Default Charset        : iso-8859-1
3.  Enable lossy encoding  : false

R   Return to Main Menu
C   Turn color off
S   Save data
Q   Quit

Command >> 2 // 2 입력

This option controls what character set is used when sending
mail and when sending HTML to the browser.

This option is used only when default language is 'en_US'.

[iso-8859-1]: utf-8 // utf-8 입력

SquirrelMail Configuration : Read: config.php (1.4.0)
---------------------------------------------------------
Language preferences
1.  Default Language       : ko_KR
2.  Default Charset        : utf-8
3.  Enable lossy encoding  : false

R   Return to Main Menu
C   Turn color off
S   Save data
Q   Quit

Command >> S // S 입력

Data saved in config.php
Press enter to continue... // Enter 치기!

SquirrelMail Configuration : Read: config.php (1.4.0)
---------------------------------------------------------
Language preferences
1.  Default Language       : ko_KR
2.  Default Charset        : utf-8
3.  Enable lossy encoding  : false

R   Return to Main Menu
C   Turn color off
S   Save data
Q   Quit

Command >> Q // Q 입력

```



##### <4. 웹 서비스 구성 정보 확인 및 구동>

###### WebMail

[root@Linux-04 ~]# vim /etc/httpd/conf.d/squirrelmail.conf

```
 16   RewriteCond    %{HTTPS} !=off // on -> off 로 변경

평문 웹 통신을 사용할 거기 때문에!
```

[root@Linux-04 ~]# vim /etc/postfix/main.cf

```
77 myhostname = mail.2bwithu.com // 변경해주기
85 mydomain = 2bwithu.com // 변경해주기
```

[root@Linux-04 ~]# service postfix restart

```
postfix 종료 중:                                           [  OK  ]
postfix를 시작 중:                                         [  OK  ]
```

[root@Linux-04 ~]# service dovecot restart

```
Dovecot Imap 를 정지 중:                                   [  OK  ]
seDovecot Imap (을)를 시작 중:                             [  OK  ]
```

[root@Linux-04 ~]# service httpd restart

```
httpd 를 정지 중:                                          [실패]
httpd (을)를 시작 중: httpd: apr_sockaddr_info_get() failed for Linux-04
httpd: Could not reliably determine the server's fully qualified domain name, using 127.0.0.1 for ServerName
                                                           [  OK  ] -> 여기OK만 뜨면 됨 ㅇㅇ
```

[root@Linux-04 ~]# 

[root@Linux-04 ~]# vim /etc/resolv.conf

```
; generated by /sbin/dhclient-script
nameserver 10.10.10.100 // 이거 추가해주기
nameserver 8.8.8.8

```

[root@Linux-04 ~]# rndc flush // 안뜬다면 
[root@Linux-04 ~]# service named stop // 정지시켜주기
named 정지 중: .                                           [  OK  ]

[root@Linux-04 ~]# chkconfig postfix on
[root@Linux-04 ~]# chkconfig dovecot on
[root@Linux-04 ~]# chkconfig httpd on
[root@Linux-04 ~]# chkconfig named off //DNS 꺼주기
[root@Linux-04 ~]# reboot

리붓 후 

[root@Linux-04 ~]#vim /etc/resolv.conf

```
; generated by /sbin/dhclient-script
nameserver 10.10.10.100 // 이거 다시 추가해주기
nameserver 8.8.8.8
```



###### Clinet

1. 인터넷 실행 (Internet Explorer)

2. http://mail.2bwithu.com/webmail -> 로그인 ( ID : ktest / PW : keroro2424.)

   

###### 오류남 

다시  WebMail 가서 

[root@Linux-04 바탕화면]# service httpd restart

[root@Linux-04 바탕화면]# service dovecot restart

Client 가서 도구 -> 인터넷 옵션 -> 기록, 쿠키 삭제 해주고 다시 인터넷 실행

다람쥐새끼 뜸  로그인도 됨 후



3. 메일 보내보기

1) WebMail 에서 파이어폭스 -> http://mail.2bwithu.com/webmail -> 로그인  (ID : ms / PW : keroro2424.)

2) Client 에서 ms@2bwithu.com 으로 메일 보내보기 -> 성공



